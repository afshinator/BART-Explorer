<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Yet Another BART App.">

    <title>BART Explorer &ndash; Home &ndash; Afshin Mokhtari</title>

    
<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
<!-- <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"> -->
<link rel="stylesheet" href="./css/font-awesome.min.css">
  
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="css/layouts/side-menu-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="css/layouts/side-menu.css">
    <!--<![endif]-->
  

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
    <!--<![endif]-->
<link rel="stylesheet" href="./css/app.css">

</head>
<body>



<div id="layout">
    <!-- Menu toggle -->
    <a href="#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>

    <div id="menu">
        <div class="pure-menu pure-menu-open">
            <a class="pure-menu-heading" href="#">BARTGoer <i class="fa fa-bus"></i></a>

            <ul>
                <li class="menu-item-divided pure-menu-selected"><a href="#">Home</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#"><i class="fa fa-cogs"></i> Settings</a></li>
            </ul>
        </div>
        <div id="infoArea">
        </div>
    </div>

    <div id="main">
        <div class="header">
            <h1>BARTGoer</h1>
        </div>


        <div class="content">
            <form class="pure-form">
                <fieldset>
                    <!-- <legend>Choose your Start and Destination Stations</legend> -->
                    <div class="pure-g">
                        <div class="pure-u-1 pure-u-sm-2-5">
                            <label for="start">Starting Point</label>
                            <select id="origin">
                            </select>
                        </div>
                        <div class="pure-u-1 pure-u-sm-2-5">                        
                            <label for="dest">Destination</label>
                            <select id="dest">
                                <!-- <option val="">Richmond</option> -->
                            </select>
                        </div>
                        <div class="pure-u-1 pure-u-sm-1-5">                        
<form class="pure-form">
    <label for="option-one" class="pure-checkbox">
        <input id="option-one" type="checkbox" value="">
        Some option
    </label>
</form>
                        </div>                        
                    </div>
                    <br>
                    <div class="pure-g">
                        <button id="fare" class="pure-button fonts">
                            <i class="fa fa-usd"></i>
                            Fare  
                        </button>
                        <button id="arrive" class="pure-button fonts">
                            <i class="fa fa-level-down"></i>
                            Arrive  
                        </button>
                        <button id="depart" class="pure-button fonts">
                            <i class="fa fa-level-up"></i>
                            Depart  
                        </button>                                                
                    </div>
                </fieldset>
            </form>
        </div>  <!-- end content -->

        <div class="pure-g">

            <div class="pure-u-1">
                <img class="pure-img-responsive" src="http://res.cloudinary.com/techblogpics/image/upload/v1418431130/bart-50_ufttkq.png" alt = "bart image" width="1140" height="1038" border="0" usemap="#map">

                <map name="map">
                    <area name="rich" id="a-rich" shape="circle" coords="330,156,15" alt="Richmond" href="#" />
                    <area id="a-woak" shape="circle" coords="365,407,16" alt="woak" href="#"/>
                    <area shape="circle" coords="476,275,9" alt="alt text" href="#" />
                    <area id="a-orin" shape="circle" coords="527,246,8" alt="orinda" href="#" />
                    <area shape="circle" coords="685,148,8" alt="Pleasant Hill" href="#"/>
                    <area shape="rect" coords="414,311,448,322" alt="Macaruthur" href="#" />
                    <area shape="circle" coords="837,56,10" alt="Pittsburg/Bay Point" href="#"/>
                    <area shape="rect" coords="256,727,282,749" alt="Millbrae" href="#" />
                </map>
            </div>
        </div>


    </div>
</div>



<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="./js/jquery.rwdImageMaps.min.js"></script>

<!-- <script src="./js/ios-orientationchange-fix.min.js"></script> -->
<script src="./js/ui.js"></script>
<script type="text/javascript">
  var stations = {
    '12TH': '12th St. / Oakland City Center',
    '16TH': '16th St. Mission',
    '19TH': '19th St. Oakland',
    '24TH': '24th St. Mission',
    'ASHB': 'Ashby',
    'BALB': 'Balboa Park',
    'BAYF': 'Bay Fair',
    'CAST': 'Castro Valley',
    'CIVC': 'Civic Center',
    'COLS': 'Coliseum / Oakland Airport',
    'COLM': 'Colma',
    'CONC': 'Concord',
    'DALY': 'Daly City',
    'DBRK': 'Downtown Berkeley',
    'DUBL': 'Dublin / Pleasanton',
    'DELN': 'El Cerrito del Norte',
    'PLZA': 'El Cerrito Plaza',
    'EMBR': 'Embarcadero',
    'FRMT': 'Fremont',
    'FTVL': 'Fruitvale',
    'GLEN': 'Glen Park',
    'HAYW': 'Hayward',
    'LAFY': 'Lafayette',
    'LAKE': 'Lake Merritt',
    'MCAR': 'MacArthur',
    'MLBR': 'Millbrae',
    'MONT': 'Montgomery St.',
    'NBRK': 'North Berkeley',
    'NCON': 'North Concord/Martinez',
    'ORIN': 'Orinda',
    'PITT': 'Pittsburg / Bay Point',
    'PHIL': 'Pleasant Hill',
    'POWL': 'Powell St.',
    'RICH': 'Richmond',
    'ROCK': 'Rockridge',
    'SBRN': 'San Bruno',
    'SANL': 'San Leandro',
    'SFIA': 'SFO Airport',
    'SHAY': 'South Hayward',
    'SSAN': 'South San Francisco',
    'UCTY': 'Union City',
    'WCRK': 'Walnut Creek',
    'WDUB': 'West Dublin / Pleasanton',
    'WOAK': 'West Oakland',
    'SPCL': 'Special'
  };

    function supports_html5_storage() {
      try {
        return 'localStorage' in window && window['localStorage'] !== null;
      } catch (e) {
        return false;
      }
    }




    $(function() {
        var origin, 
            dest,
            savedPrefs = false;
            $origin = $('#origin'),
            $dest = $('#dest')
            $info = $('#infoArea'),
            $fare = $('#fare'),
            $arrive = $('#arrive');



        var getOriginDest = function() {
            origin = $origin.find('option:selected').val();
            dest = $dest.find('option:selected').val();

            console.log( 'orig: ' + origin );
            console.log( 'dest: ' + dest );            
        };

        var fillSelectControl = function() {
            var str = '';
            for (var key in stations) {
                str += '<option value="' + key + '">' + stations[key] + '</options>';
            }
            $origin.empty().append( str );
            $dest.empty().append( str );
        };

        var init = function() {
            var storageData = {};

            fillSelectControl();            
            getOriginDest();
            if ( ! supports_html5_storage() ) console.err('No localStorage');
            else {
                if ( localStorage.bartgoer !== undefined ) {
                    storageData = JSON.parse( localStorage.bartgoear );
                }
            }
        }();


        $('img[usemap]').rwdImageMaps();

        $('area').on('click', function() {
            alert($(this).attr('alt') + ' clicked');
        });

        $('area').on('mouseover mouseout', function(event) {
  var msg = "Handler for .mousemove() called at ";
  msg += event.pageX + ", " + event.pageY;
  console.log(msg);
  console.log( 'name' + $(this).attr('name') );
            if (event.type == 'mouseover') {
                $(this).data('bgcolor', $(this).css('background-color'));
                $(this).css('background-color','rgba(255,0,0,.5)');
            } else {
                $(this).css('background-color', $(this).data('bgcolor'));
            }
            return false;
        });


        $('select').change( function() {
            getOriginDest();
            // var str = "";
            // $( "select option:selected" ).each(function() {
            //   str += $( this ).text() + " ";
            // });
            // console.log( str);
        });

        $fare.click(function(){
            var url = 'http://api.bart.gov/api/sched.aspx?cmd=fare&orig=' + origin + '&dest=' + dest,
                thisCache = $(this);

            thisCache.addClass('button-warning');
            $.get( url, function( data ) {
                var txt = '<p>fare: $' + $(data).find('fare').text() + '</p>';
                txt += '<small>From ' + origin + ' to ' + dest + '</small>';
                $info.empty().append( txt );
                console.log( 'fare : $' + $(data).find('fare').text() );
                thisCache.fadeOut(400).removeClass('button-warning').fadeIn();
            });
        });

        $arrive.click( function() {
            var url = 'http://api.bart.gov/api/sched.aspx?cmd=arrive&orig=' + origin + '&dest=' + dest,
                thisCache = $(this);

            url += '&date=now&b=2&a=2&l=1';
            thisCache.addClass('button-warning');
            $.get( url, function( data ) {

                console.log(  data );
                thisCache.fadeOut(400).removeClass('button-warning').fadeIn();
            });            

        });


    });

</script>

</body>
</html>
